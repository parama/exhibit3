<!DOCTYPE html><html><head><title>exhibit.js</title><meta http-equiv="Content-Type" content="text/html" charset="UTF-8"><link rel="stylesheet" media="all" href="./docco.css"></head><body><div id="container"><div id="background"></div><div id="jump_to">Jump To &hellip;<div id="jump_wrapper"><div id="jump_page"><a href="./index.html" class="source"><span class="file_name">README</span></a><a href="./create.js.html" class="source "><span class="base_path">. / </span><span class="file_name">create.js</span></a><a href="./exhibit.js.html" class="source selected"><span class="base_path">. / </span><span class="file_name">exhibit.js</span></a><a href="./final.js.html" class="source "><span class="base_path">. / </span><span class="file_name">final.js</span></a><a href="./registry.js.html" class="source "><span class="base_path">. / </span><span class="file_name">registry.js</span></a></div></div></div><table cellpadding="0" cellspacing="0"><thead><tr><th class="docs"><h1>exhibit.js</h1><div class="filepath">./</div></th><th class="code"></th></tr></thead><tbody><tr id="section-1"><td class="docs"><div class="pilwrap"><a href="#section-1" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>@fileOverview</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre></pre></div></td></tr><tr id="section-2"><td class="docs"><div class="pilwrap"><a href="#section-2" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>@static</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>database </span><span class="dox_type">Exhibit.Database</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Exhibit</span><span class="p">.</span><span class="nx">create</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">database</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">Exhibit</span><span class="p">.</span><span class="nx">_Impl</span><span class="p">(</span><span class="nx">database</span><span class="p">);</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-3"><td class="docs"><div class="pilwrap"><a href="#section-3" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Check for instances of ex:role and throw into backwards compatibility<br />mode if any are found.  Authors are responsible for converting or using<br />the HTML5 attributes correctly; backwards compatibility is only applicable<br />when used with unconverted Exhibits.</p></div><div class="details"><div class="dox_tag_title">See</div><div class="dox_tag_detail"><span class="dox_type">Exhibit.Backwards</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Exhibit</span><span class="p">.</span><span class="nx">checkBackwardsCompatibility</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">exroles</span><span class="p">;</span>
    <span class="nx">exroles</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">).</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">typeof</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;ex:role&quot;</span><span class="p">)</span> <span class="o">!==</span> <span class="s2">&quot;undefined&quot;</span><span class="p">;</span>
    <span class="p">});</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">exroles</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">Exhibit</span><span class="p">.</span><span class="nx">Backwards</span><span class="p">.</span><span class="nx">enable</span><span class="p">(</span><span class="s2">&quot;Attributes&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-4"><td class="docs"><div class="pilwrap"><a href="#section-4" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Retrieve an Exhibit-specific attribute from an element.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>elmt </span><span class="dox_type">jQuery</span><span class="dox_type">Element</span></div><div class="dox_tag_detail"><span>name </span><span class="dox_type">String</span><span>- Full attribute name or Exhibit attribute (without any</span></div><div class="dox_tag_detail"><span>splitOn </span><span class="dox_type">String</span><span>- Separator character to split a string</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Exhibit</span><span class="p">.</span><span class="nx">getAttribute</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">elmt</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">splitOn</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">values</span><span class="p">;</span>

    <span class="k">try</span> <span class="p">{</span>
        <span class="nx">value</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">elmt</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">value</span> <span class="o">===</span> <span class="s2">&quot;undefined&quot;</span> <span class="o">||</span> <span class="nx">value</span> <span class="o">===</span> <span class="kc">null</span> <span class="o">||</span> <span class="nx">value</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">value</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">elmt</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="s2">&quot;ex-&quot;</span><span class="o">+</span><span class="nx">name</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">value</span> <span class="o">===</span> <span class="s2">&quot;undefined&quot;</span> <span class="o">||</span> <span class="nx">value</span> <span class="o">===</span> <span class="kc">null</span> <span class="o">||</span> <span class="nx">value</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">splitOn</span> <span class="o">===</span> <span class="s2">&quot;undefined&quot;</span> <span class="o">||</span> <span class="nx">splitOn</span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">value</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nx">values</span> <span class="o">=</span> <span class="nx">value</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="nx">splitOn</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">values</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">values</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">values</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">trim</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">values</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-5"><td class="docs"><div class="pilwrap"><a href="#section-5" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>@static</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>elmt </span><span class="dox_type">Element</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Exhibit</span><span class="p">.</span><span class="nx">getRoleAttribute</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">elmt</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">role</span> <span class="o">=</span> <span class="nx">Exhibit</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="nx">elmt</span><span class="p">,</span> <span class="s2">&quot;role&quot;</span><span class="p">)</span> <span class="o">||</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">role</span> <span class="o">===</span> <span class="s2">&quot;object&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">role</span> <span class="o">=</span> <span class="nx">role</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="nx">role</span> <span class="o">=</span> <span class="nx">role</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^exhibit-/</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">role</span><span class="p">;</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-6"><td class="docs"><div class="pilwrap"><a href="#section-6" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Process a DOM element's attribute name to see if it is an Exhibit<br />attribute.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>name </span><span class="dox_type">String</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Exhibit</span><span class="p">.</span><span class="nx">isExhibitAttribute</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">name</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="s2">&quot;data-ex-&quot;</span><span class="p">.</span><span class="nx">length</span>
        <span class="o">&amp;&amp;</span> <span class="nx">name</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="s2">&quot;data-ex-&quot;</span><span class="p">);</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-7"><td class="docs"><div class="pilwrap"><a href="#section-7" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Process a DOM element's attribute and convert it into the name Exhibit<br />uses internally.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>name </span><span class="dox_type">String</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Exhibit</span><span class="p">.</span><span class="nx">extractAttributeName</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">name</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="s2">&quot;data-ex-&quot;</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-8"><td class="docs"><div class="pilwrap"><a href="#section-8" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Turn an internal attribute name into something that can be inserted into<br />the DOM and correctly re-extracted later as an Exhibit attribute.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>name </span><span class="dox_type">String</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Exhibit</span><span class="p">.</span><span class="nx">makeExhibitAttribute</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">exname</span><span class="p">;</span>
    <span class="k">switch</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">case</span> <span class="s2">&quot;itemID&quot;</span><span class="o">:</span>
            <span class="nx">exname</span> <span class="o">=</span> <span class="s2">&quot;itemid&quot;</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="k">default</span><span class="o">:</span>
            <span class="nx">exname</span> <span class="o">=</span> <span class="s2">&quot;data-ex-&quot;</span> <span class="o">+</span> <span class="nx">name</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/([A-Z])/g</span><span class="p">,</span> <span class="s2">&quot;-$1&quot;</span><span class="p">).</span><span class="nx">toLowerCase</span><span class="p">();</span>
            <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">exname</span><span class="p">;</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-9"><td class="docs"><div class="pilwrap"><a href="#section-9" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>@static</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>elmt </span><span class="dox_type">Element</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Exhibit</span><span class="p">.</span><span class="nx">getConfigurationFromDOM</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">elmt</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">c</span><span class="p">,</span> <span class="nx">o</span><span class="p">;</span>
    <span class="nx">c</span> <span class="o">=</span> <span class="nx">Exhibit</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="nx">elmt</span><span class="p">,</span> <span class="s2">&quot;configuration&quot;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">c</span> <span class="o">!==</span> <span class="s2">&quot;undefined&quot;</span> <span class="o">&amp;&amp;</span> <span class="nx">c</span> <span class="o">!==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="nx">c</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">try</span><span class="p">{</span>
            <span class="nx">o</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="nx">c</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">o</span> <span class="o">===</span> <span class="s2">&quot;object&quot;</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">o</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="p">{};</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-10"><td class="docs"><div class="pilwrap"><a href="#section-10" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>This method is not commonly used.  Consider using Exhibit.SettingsUtilties.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>elmt </span><span class="dox_type">Element</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Exhibit</span><span class="p">.</span><span class="nx">extractOptionsFromElement</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">elmt</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">dataset</span><span class="p">,</span> <span class="nx">i</span><span class="p">;</span>
    <span class="nx">opts</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="nx">dataset</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">elmt</span><span class="p">).</span><span class="nx">data</span><span class="p">();</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="k">in</span> <span class="nx">dataset</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">i</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">i</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="s2">&quot;ex&quot;</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">opts</span><span class="p">[</span><span class="nx">i</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span> <span class="o">=</span> <span class="nx">dataset</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">opts</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">dataset</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">opts</span><span class="p">;</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-11"><td class="docs"><div class="pilwrap"><a href="#section-11" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>@public</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>database </span><span class="dox_type">Exhibit.Database</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Exhibit</span><span class="p">.</span><span class="nx">_Impl</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">database</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">_database</span> <span class="o">=</span> <span class="p">(</span><span class="nx">database</span> <span class="o">!==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">database</span> <span class="o">!==</span> <span class="s2">&quot;undefined&quot;</span><span class="p">)</span> <span class="o">?</span> 
        <span class="nx">database</span> <span class="o">:</span> 
        <span class="p">(</span><span class="k">typeof</span> <span class="nb">window</span><span class="p">[</span><span class="s2">&quot;database&quot;</span><span class="p">]</span> <span class="o">!==</span> <span class="s2">&quot;undefined&quot;</span> <span class="o">?</span>
            <span class="nb">window</span><span class="p">.</span><span class="nx">database</span> <span class="o">:</span>
            <span class="nx">Exhibit</span><span class="p">.</span><span class="nx">Database</span><span class="p">.</span><span class="nx">create</span><span class="p">());</span>
            
    <span class="k">this</span><span class="p">.</span><span class="nx">_uiContext</span> <span class="o">=</span> <span class="nx">Exhibit</span><span class="p">.</span><span class="nx">UIContext</span><span class="p">.</span><span class="nx">createRootContext</span><span class="p">({},</span> <span class="k">this</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">_registry</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Exhibit</span><span class="p">.</span><span class="nx">Registry</span><span class="p">();</span>
    <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">&quot;registerComponents.exhibit&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_registry</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">_collectionMap</span> <span class="o">=</span> <span class="p">{};</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-12"><td class="docs"><div class="pilwrap"><a href="#section-12" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Exhibit</span><span class="p">.</span><span class="nx">_Impl</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">dispose</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">id</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="nx">id</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="nx">_collectionMap</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_collectionMap</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">id</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">_collectionMap</span><span class="p">[</span><span class="nx">id</span><span class="p">].</span><span class="nx">dispose</span><span class="p">();</span>
            <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">ex2</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Exhibit</span><span class="p">.</span><span class="nx">Debug</span><span class="p">.</span><span class="nx">exception</span><span class="p">(</span><span class="nx">ex2</span><span class="p">,</span> <span class="nx">Exhibit</span><span class="p">.</span><span class="nx">_</span><span class="p">(</span><span class="s2">&quot;%general.error.disposeCollection&quot;</span><span class="p">));</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">_uiContext</span><span class="p">.</span><span class="nx">dispose</span><span class="p">();</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">_collectionMap</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">_uiContext</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">_database</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">_registry</span><span class="p">.</span><span class="nx">dispose</span><span class="p">();</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">_registry</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-13"><td class="docs"><div class="pilwrap"><a href="#section-13" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>@returns {Exhibit.Database}</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Exhibit</span><span class="p">.</span><span class="nx">_Impl</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getDatabase</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_database</span><span class="p">;</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-14"><td class="docs"><div class="pilwrap"><a href="#section-14" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>@returns {Exhibit.Registry}</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Exhibit</span><span class="p">.</span><span class="nx">_Impl</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getRegistry</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_registry</span><span class="p">;</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-15"><td class="docs"><div class="pilwrap"><a href="#section-15" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>@returns {Exhibit.UIContext}</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Exhibit</span><span class="p">.</span><span class="nx">_Impl</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getUIContext</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_uiContext</span><span class="p">;</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-16"><td class="docs"><div class="pilwrap"><a href="#section-16" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>@param {String} id</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Exhibit</span><span class="p">.</span><span class="nx">_Impl</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getCollection</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">collection</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_collectionMap</span><span class="p">[</span><span class="nx">id</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">((</span><span class="k">typeof</span> <span class="nx">collection</span> <span class="o">===</span> <span class="s2">&quot;undefined&quot;</span> <span class="o">||</span> <span class="nx">collection</span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">id</span> <span class="o">===</span> <span class="s2">&quot;default&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">collection</span> <span class="o">=</span> <span class="nx">Exhibit</span><span class="p">.</span><span class="nx">Collection</span><span class="p">.</span><span class="nx">createAllItemsCollection</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_database</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">setDefaultCollection</span><span class="p">(</span><span class="nx">collection</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">collection</span><span class="p">;</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-17"><td class="docs"><div class="pilwrap"><a href="#section-17" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>@returns {Exhibit.Collection}</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Exhibit</span><span class="p">.</span><span class="nx">_Impl</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getDefaultCollection</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">getCollection</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">);</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-18"><td class="docs"><div class="pilwrap"><a href="#section-18" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>@param {String} id</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>c </span><span class="dox_type">Exhibit.Collection</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Exhibit</span><span class="p">.</span><span class="nx">_Impl</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setCollection</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">c</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="k">this</span><span class="p">.</span><span class="nx">_collectionMap</span><span class="p">[</span><span class="nx">id</span><span class="p">]</span> <span class="o">!==</span> <span class="s2">&quot;undefined&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">try</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_collectionMap</span><span class="p">[</span><span class="nx">id</span><span class="p">].</span><span class="nx">dispose</span><span class="p">();</span>
        <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">Exhibit</span><span class="p">.</span><span class="nx">Debug</span><span class="p">.</span><span class="nx">exception</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">_collectionMap</span><span class="p">[</span><span class="nx">id</span><span class="p">]</span> <span class="o">=</span> <span class="nx">c</span><span class="p">;</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-19"><td class="docs"><div class="pilwrap"><a href="#section-19" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>@param {Exhibit.Collection} c</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Exhibit</span><span class="p">.</span><span class="nx">_Impl</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setDefaultCollection</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setCollection</span><span class="p">(</span><span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="nx">c</span><span class="p">);</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-20"><td class="docs"><div class="pilwrap"><a href="#section-20" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>@param {String} id</p></div><div class="details"></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Exhibit</span><span class="p">.</span><span class="nx">_Impl</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getComponent</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">getRegistry</span><span class="p">().</span><span class="nx">getID</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-21"><td class="docs"><div class="pilwrap"><a href="#section-21" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>@param {Object} configuration</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Exhibit</span><span class="p">.</span><span class="nx">_Impl</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">configure</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">configuration</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">config</span><span class="p">,</span> <span class="nx">id</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">configuration</span><span class="p">[</span><span class="s2">&quot;collections&quot;</span><span class="p">]</span> <span class="o">!==</span> <span class="s2">&quot;undefined&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">configuration</span><span class="p">.</span><span class="nx">collections</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">config</span> <span class="o">=</span> <span class="nx">configuration</span><span class="p">.</span><span class="nx">collections</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="nx">id</span> <span class="o">=</span> <span class="nx">config</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">id</span> <span class="o">===</span> <span class="s2">&quot;undefined&quot;</span> <span class="o">||</span> <span class="nx">id</span> <span class="o">===</span> <span class="kc">null</span> <span class="o">||</span> <span class="nx">id</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">id</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">setCollection</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">Exhibit</span><span class="p">.</span><span class="nx">Collection</span><span class="p">.</span><span class="nx">create2</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">config</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_uiContext</span><span class="p">));</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">configuration</span><span class="p">[</span><span class="s2">&quot;components&quot;</span><span class="p">]</span> <span class="o">!==</span> <span class="s2">&quot;undefined&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">configuration</span><span class="p">.</span><span class="nx">components</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">config</span> <span class="o">=</span> <span class="nx">configuration</span><span class="p">.</span><span class="nx">components</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="nx">component</span> <span class="o">=</span> <span class="nx">Exhibit</span><span class="p">.</span><span class="nx">UI</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">config</span><span class="p">,</span> <span class="nx">config</span><span class="p">.</span><span class="nx">elmt</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_uiContext</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-22"><td class="docs"><div class="pilwrap"><a href="#section-22" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Set up this Exhibit's view from its DOM configuration.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>[root] </span><span class="dox_type">Node</span><span>- optional root node, below which configuration gets read</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Exhibit</span><span class="p">.</span><span class="nx">_Impl</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">configureFromDOM</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">root</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">controlPanelElmts</span><span class="p">,</span> <span class="nx">collectionElmts</span><span class="p">,</span> <span class="nx">coderElmts</span><span class="p">,</span> <span class="nx">coordinatorElmts</span><span class="p">,</span> <span class="nx">lensElmts</span><span class="p">,</span> <span class="nx">facetElmts</span><span class="p">,</span> <span class="nx">otherElmts</span><span class="p">,</span> <span class="nx">f</span><span class="p">,</span> <span class="nx">uiContext</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">elmt</span><span class="p">,</span> <span class="nx">id</span><span class="p">,</span> <span class="nx">self</span><span class="p">,</span> <span class="nx">processElmts</span><span class="p">,</span> <span class="nx">exporters</span><span class="p">,</span> <span class="nx">expr</span><span class="p">,</span> <span class="nx">exporter</span><span class="p">,</span> <span class="nx">hash</span><span class="p">,</span> <span class="nx">itemID</span><span class="p">;</span>

    <span class="nx">collectionElmts</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="nx">coderElmts</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="nx">coordinatorElmts</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="nx">lensElmts</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="nx">facetElmts</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="nx">controlPanelElmts</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="nx">otherElmts</span> <span class="o">=</span> <span class="p">[];</span>

    <span class="nx">f</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">elmt</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">role</span><span class="p">,</span> <span class="nx">node</span><span class="p">;</span>
        <span class="nx">role</span> <span class="o">=</span> <span class="nx">Exhibit</span><span class="p">.</span><span class="nx">getRoleAttribute</span><span class="p">(</span><span class="nx">elmt</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">role</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">switch</span> <span class="p">(</span><span class="nx">role</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">case</span> <span class="s2">&quot;collection&quot;</span><span class="o">:</span>  <span class="nx">collectionElmts</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">elmt</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="s2">&quot;coder&quot;</span><span class="o">:</span>       <span class="nx">coderElmts</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">elmt</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="s2">&quot;coordinator&quot;</span><span class="o">:</span> <span class="nx">coordinatorElmts</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">elmt</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="s2">&quot;lens&quot;</span><span class="o">:</span>
            <span class="k">case</span> <span class="s2">&quot;submission-lens&quot;</span><span class="o">:</span>
            <span class="k">case</span> <span class="s2">&quot;edit-lens&quot;</span><span class="o">:</span>   <span class="nx">lensElmts</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">elmt</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="s2">&quot;facet&quot;</span><span class="o">:</span>       <span class="nx">facetElmts</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">elmt</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="s2">&quot;controlPanel&quot;</span><span class="o">:</span> <span class="nx">controlPanelElmts</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">elmt</span><span class="p">);</span> <span class="k">break</span><span class="p">;</span>
            <span class="k">default</span><span class="o">:</span> 
                <span class="nx">otherElmts</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">elmt</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">node</span> <span class="o">=</span> <span class="nx">elmt</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">;</span>
            <span class="k">while</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">node</span> <span class="o">!==</span> <span class="s2">&quot;undefined&quot;</span> <span class="o">&amp;&amp;</span> <span class="nx">node</span> <span class="o">!==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">f</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="nx">node</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">nextSibling</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">};</span>
    <span class="nx">f</span><span class="p">(</span><span class="nx">root</span> <span class="o">||</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">);</span>
    
    <span class="nx">uiContext</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_uiContext</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">collectionElmts</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">elmt</span> <span class="o">=</span> <span class="nx">collectionElmts</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="nx">id</span> <span class="o">=</span> <span class="nx">elmt</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">id</span> <span class="o">===</span> <span class="s2">&quot;undefined&quot;</span> <span class="o">||</span> <span class="nx">id</span> <span class="o">===</span> <span class="kc">null</span> <span class="o">||</span> <span class="nx">id</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">id</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">setCollection</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">Exhibit</span><span class="p">.</span><span class="nx">Collection</span><span class="p">.</span><span class="nx">createFromDOM2</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">elmt</span><span class="p">,</span> <span class="nx">uiContext</span><span class="p">));</span>
    <span class="p">}</span>
    
    <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="nx">processElmts</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">elmts</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">elmt</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">elmts</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">elmt</span> <span class="o">=</span> <span class="nx">elmts</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="nx">Exhibit</span><span class="p">.</span><span class="nx">UI</span><span class="p">.</span><span class="nx">createFromDOM</span><span class="p">(</span><span class="nx">elmt</span><span class="p">,</span> <span class="nx">uiContext</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">ex1</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Exhibit</span><span class="p">.</span><span class="nx">Debug</span><span class="p">.</span><span class="nx">exception</span><span class="p">(</span><span class="nx">ex1</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">};</span>

    <span class="nx">processElmts</span><span class="p">(</span><span class="nx">coordinatorElmts</span><span class="p">);</span>
    <span class="nx">processElmts</span><span class="p">(</span><span class="nx">coderElmts</span><span class="p">);</span>
    <span class="nx">processElmts</span><span class="p">(</span><span class="nx">lensElmts</span><span class="p">);</span>
    <span class="nx">processElmts</span><span class="p">(</span><span class="nx">facetElmts</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">controlPanelElmts</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">panel</span> <span class="o">=</span> <span class="nx">Exhibit</span><span class="p">.</span><span class="nx">ControlPanel</span><span class="p">.</span><span class="nx">createFromDOM</span><span class="p">(</span>
            <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;&lt;div&gt;&quot;</span><span class="p">).</span><span class="nx">prependTo</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">),</span>
            <span class="kc">null</span><span class="p">,</span>
            <span class="nx">uiContext</span>
        <span class="p">);</span>
        <span class="nx">panel</span><span class="p">.</span><span class="nx">setCreatedAsDefault</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">processElmts</span><span class="p">(</span><span class="nx">controlPanelElmts</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">processElmts</span><span class="p">(</span><span class="nx">otherElmts</span><span class="p">);</span>
    
    <span class="nx">exporters</span> <span class="o">=</span> <span class="nx">Exhibit</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">,</span> <span class="s2">&quot;exporters&quot;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">exporters</span> <span class="o">!==</span> <span class="s2">&quot;undefined&quot;</span> <span class="o">&amp;&amp;</span> <span class="nx">exporters</span> <span class="o">!==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">exporters</span> <span class="o">=</span> <span class="nx">exporters</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">exporters</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">expr</span> <span class="o">=</span> <span class="nx">exporters</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
            <span class="nx">exporter</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
            
            <span class="k">try</span> <span class="p">{</span>
                <span class="nx">exporter</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="nx">expr</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">ex2</span><span class="p">)</span> <span class="p">{}</span>
            
            <span class="k">if</span> <span class="p">(</span><span class="nx">exporter</span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">try</span> <span class="p">{</span> <span class="nx">exporter</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="nx">expr</span> <span class="o">+</span> <span class="s2">&quot;Exporter&quot;</span><span class="p">);</span> <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">ex3</span><span class="p">)</span> <span class="p">{}</span>
            <span class="p">}</span>
            
            <span class="k">if</span> <span class="p">(</span><span class="nx">exporter</span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">try</span> <span class="p">{</span> <span class="nx">exporter</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="s2">&quot;Exhibit.&quot;</span> <span class="o">+</span> <span class="nx">expr</span> <span class="o">+</span> <span class="s2">&quot;Exporter&quot;</span><span class="p">);</span> <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">ex4</span><span class="p">)</span> <span class="p">{}</span>
            <span class="p">}</span>
            
            <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">exporter</span> <span class="o">===</span> <span class="s2">&quot;object&quot;</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Exhibit</span><span class="p">.</span><span class="nx">addExporter</span><span class="p">(</span><span class="nx">exporter</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="nx">hash</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">hash</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">hash</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">itemID</span> <span class="o">=</span> <span class="nb">decodeURIComponent</span><span class="p">(</span><span class="nx">hash</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_database</span><span class="p">.</span><span class="nx">containsItem</span><span class="p">(</span><span class="nx">itemID</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_showFocusDialogOnItem</span><span class="p">(</span><span class="nx">itemID</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">&quot;exhibitConfigured.exhibit&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
<span class="p">};</span></pre></div></td></tr><tr id="section-23"><td class="docs"><div class="pilwrap"><a href="#section-23" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>@private</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>itemID </span><span class="dox_type">String</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="nx">Exhibit</span><span class="p">.</span><span class="nx">_Impl</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">_showFocusDialogOnItem</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">itemID</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">dom</span><span class="p">,</span> <span class="nx">itemLens</span><span class="p">;</span>
    <span class="nx">dom</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">simileDOM</span><span class="p">(</span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
        <span class="s2">&quot;div&quot;</span><span class="p">,</span>
        <span class="s2">&quot;&lt;div class=&#39;exhibit-focusDialog-viewContainer&#39; id=&#39;lensContainer&#39;&gt;&quot;</span> <span class="o">+</span>
        <span class="s2">&quot;&lt;/div&gt;&quot;</span> <span class="o">+</span>
        <span class="s2">&quot;&lt;div class=&#39;exhibit-focusDialog-controls&#39;&gt;&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;&lt;button id=&#39;closeButton&#39;&gt;&quot;</span> <span class="o">+</span> 
                      <span class="nx">Exhibit</span><span class="p">.</span><span class="nx">_</span><span class="p">(</span><span class="s2">&quot;%export.focusDialogBoxCloseButtonLabel&quot;</span><span class="p">)</span> <span class="o">+</span> 
            <span class="s2">&quot;&lt;/button&gt;&quot;</span> <span class="o">+</span>
        <span class="s2">&quot;&lt;/div&gt;&quot;</span>
    <span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="nx">dom</span><span class="p">.</span><span class="nx">elmt</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;exhibit-focusDialog exhibit-ui-protection&quot;</span><span class="p">);</span>
    <span class="nx">Exhibit</span><span class="p">.</span><span class="nx">UI</span><span class="p">.</span><span class="nx">setupDialog</span><span class="p">(</span><span class="nx">dom</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    
    <span class="nx">itemLens</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_uiContext</span><span class="p">.</span><span class="nx">getLensRegistry</span><span class="p">().</span><span class="nx">createLens</span><span class="p">(</span><span class="nx">itemID</span><span class="p">,</span> <span class="nx">dom</span><span class="p">.</span><span class="nx">lensContainer</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_uiContext</span><span class="p">);</span>
    
    <span class="nx">$</span><span class="p">(</span><span class="nx">dom</span><span class="p">.</span><span class="nx">elmt</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="o">+</span> <span class="mi">100</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;px&quot;</span><span class="p">);</span>
    <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">dom</span><span class="p">.</span><span class="nx">elmt</span><span class="p">));</span>
    <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">&quot;modalSuperseded.exhibit&quot;</span><span class="p">);</span>

    <span class="nx">$</span><span class="p">(</span><span class="nx">dom</span><span class="p">.</span><span class="nx">closeButton</span><span class="p">).</span><span class="nx">bind</span><span class="p">(</span><span class="s2">&quot;click&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">dom</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
    <span class="p">});</span>
<span class="p">};</span>

</pre></div></td></tr></tbody></table><div id="generated">generated Tue Aug 14 2012 19:27:17 GMT-0400 (EDT)  </div></div></body></html>